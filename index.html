<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gerador de RelatÃ³rio - Time de Software</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body { font-family: "Inter", sans-serif; background-color: #f3f4f6; }
textarea::placeholder, input::placeholder, select::placeholder { color: #9ca3af; }
input:focus, textarea:focus, select:focus { outline: none; border-color: #6366f1; box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2); }
.message-box { padding: 0.75rem 1rem; border-radius: 0.375rem; font-size: 0.875rem; font-weight: 500; text-align: center; margin-top: 1rem; transition: opacity 0.3s ease-in-out; }
.message-box.success { background-color: #d1fae5; color: #065f46; }
.message-box.error { background-color: #fee2e2; color: #991b1b; }
.message-box.hidden { opacity: 0; height: 0; padding: 0; overflow: hidden; }
.section-activities { background-color: #d1fae5; padding: 0.75rem; border-radius: 0.5rem; }
.section-pending { background-color: #fef3c7; padding: 0.75rem; border-radius: 0.5rem; }
.section-action { background-color: #dbeafe; padding: 0.75rem; border-radius: 0.5rem; }
.section-observations { background-color: #ede9fe; padding: 0.75rem; border-radius: 0.5rem; }
</style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

<div class="bg-white p-8 rounded-2xl shadow-lg w-full max-w-2xl border border-gray-300">
<div class="flex justify-center mb-4">
<img src="Logo.jpg" alt="Logo da Empresa" class="h-16 w-auto">
</div>

<h1 class="text-3xl font-bold text-center text-gray-800 mb-6">ğŸ“ RelatÃ³rio de Atividades - Time de Software</h1>

<form id="reportForm" class="space-y-5">

<!-- Data e Nome -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
<div>
<label for="reportDate" class="block text-sm font-medium text-gray-700 mb-1">ğŸ“… Data:</label>
<input type="date" id="reportDate" class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm" required>
</div>
<div>
<label for="userName" class="block text-sm font-medium text-gray-700 mb-1">ğŸ‘¤ Nome do Colaborador:</label>
<input type="text" id="userName" placeholder="Seu Nome Completo" class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm" required>
</div>
</div>

<!-- Turno, Ãrea Trabalhada e OP -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
<div>
<label for="userShift" class="block text-sm font-medium text-gray-700 mb-1">â° Turno:</label>
<select id="userShift" class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm" required>
<option value="">Selecione o Turno</option>
<option value="ManhÃ£">ManhÃ£</option>
<option value="Tarde">Tarde</option>
<option value="Noite">Noite</option>
<option value="Integral">Integral</option>
</select>
</div>

<div>
<label for="workedArea" class="block text-sm font-medium text-gray-700 mb-1">ğŸ› ï¸ Ãrea Trabalhada:</label>
<select id="workedArea" class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm" required>
<option value="">Selecione a Ãrea</option>
<option value="Dorsal 1">Dorsal 1</option>
<option value="Lateral 281">Lateral 281</option>
<option value="Pavimento 281">Pavimento 281</option>
<option value="Lateral X6H">Lateral X6H</option>
<option value="Outro">Outro</option>
</select>
<input type="text" id="workedAreaOther" placeholder="Digite a Ã¡rea" class="mt-2 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm hidden">
</div>

<div>
<label for="operationNumber" class="block text-sm font-medium text-gray-700 mb-1">ğŸ”¢ OP:</label>
<input type="text" id="operationNumber" placeholder="Ex: OP220" class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm" required>
</div>
</div>

<!-- SeÃ§Ãµes coloridas -->
<div class="section-activities">
<label for="activitiesDone" class="block text-sm font-medium text-gray-700 mb-1">âœ… Atividades Realizadas:</label>
<textarea id="activitiesDone" rows="5" placeholder="Liste as atividades concluÃ­das no seu perÃ­odo." class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm resize-y" required></textarea>
</div>

<div class="section-pending">
<label for="pendingItems" class="block text-sm font-medium text-gray-700 mb-1">âš ï¸ PendÃªncias:</label>
<textarea id="pendingItems" rows="4" placeholder="Liste tudo o que ficou incompleto ou precisa de continuidade." class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm resize-y"></textarea>
</div>

<div class="section-action">
<label for="actionPlans" class="block text-sm font-medium text-gray-700 mb-1">â¡ï¸ Planos de AÃ§Ã£o:</label>
<textarea id="actionPlans" rows="4" placeholder="Descreva as aÃ§Ãµes que vocÃª ou a equipe devem realizar a seguir." class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm resize-y" required></textarea>
</div>

<div class="section-observations">
<label for="observations" class="block text-sm font-medium text-gray-700 mb-1">ğŸ’¡ ObservaÃ§Ãµes / Destaques (Opcional):</label>
<textarea id="observations" rows="3" placeholder="Qualquer observaÃ§Ã£o relevante, desafios, sucessos, sugestÃµes." class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm sm:text-sm resize-y"></textarea>
</div>

<!-- BotÃ£o -->
<button type="button" onclick="generateAndSaveReport()" class="w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-lg font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out transform hover:scale-105">
Gerar, Copiar e Salvar RelatÃ³rio
</button>

<!-- Mensagem -->
<div id="messageBox" class="message-box hidden" role="alert"></div>
</form>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const today = new Date();
    const y = today.getFullYear();
    const m = String(today.getMonth()+1).padStart(2,'0');
    const d = String(today.getDate()).padStart(2,'0');
    document.getElementById('reportDate').value = `${y}-${m}-${d}`;
});

const workedAreaSelect = document.getElementById('workedArea');
const workedAreaOther = document.getElementById('workedAreaOther');
workedAreaSelect.addEventListener('change', () => {
    if(workedAreaSelect.value==="Outro"){
        workedAreaOther.classList.remove('hidden'); workedAreaOther.required = true;
    }else{
        workedAreaOther.classList.add('hidden'); workedAreaOther.required = false; workedAreaOther.value="";
    }
});

function showMessage(msg,type='success'){
    const box=document.getElementById('messageBox');
    box.textContent=msg;
    box.className='message-box';
    box.classList.add(type);
    box.classList.remove('hidden');
    setTimeout(()=>box.classList.add('hidden'),3000);
}

function generateAndSaveReport(){
    const reportDate=document.getElementById('reportDate').value;
    const userName=document.getElementById('userName').value.trim();
    const userShift=document.getElementById('userShift').value;
    let workedArea=document.getElementById('workedArea').value;
    const workedAreaOtherValue=document.getElementById('workedAreaOther').value.trim();
    if(workedArea==="Outro") workedArea=workedAreaOtherValue;
    const operationNumber=document.getElementById('operationNumber').value.trim();
    const activitiesDone=document.getElementById('activitiesDone').value.trim();
    let pendingItems=document.getElementById('pendingItems').value.trim();
    const actionPlans=document.getElementById('actionPlans').value.trim();
    const observations=document.getElementById('observations').value.trim();

    if(!reportDate||!userName||!userShift||!workedArea||!operationNumber||!activitiesDone||!actionPlans){
        showMessage("Preencha todos os campos obrigatÃ³rios.","error");
        return;
    }
    if(pendingItems==="") pendingItems="Nenhuma pendÃªncia.";

    const [y,m,d]=reportDate.split('-');
    const formattedDate=`${d}/${m}/${y}`;

    const reportText = `
ğŸ“ *RELATÃ“RIO DE ATIVIDADES - TIME DE SOFTWARE*

*Data:* ${formattedDate}
*Nome:* ${userName}
*Turno:* ${userShift}
*Ãrea:* ${workedArea}
*OP:* ${operationNumber}

---

âœ… *1. Atividades Realizadas:*
${activitiesDone.split('\n').map(l=>`* ${l.trim()}`).join('\n')}

---

âš ï¸ *2. PendÃªncias:*
${pendingItems.split('\n').map(l=>`* ${l.trim()}`).join('\n')}

---

â¡ï¸ *3. Planos de AÃ§Ã£o:*
${actionPlans.split('\n').map(l=>`* ${l.trim()}`).join('\n')}

---

${observations?`ğŸ’¡ *4. ObservaÃ§Ãµes / Destaques:*\n${observations}\n\n---`:''}

_RelatÃ³rio gerado automaticamente._
    `.trim();

    // Copiar
    const textarea=document.createElement('textarea');
    textarea.value=reportText;
    textarea.style.position='fixed'; textarea.style.opacity=0; textarea.style.left='-9999px'; textarea.style.top='-9999px';
    document.body.appendChild(textarea);
    textarea.select();
    try{document.execCommand('copy'); showMessage("RelatÃ³rio copiado!","success");}catch(e){showMessage("Erro ao copiar","error");}
    finally{document.body.removeChild(textarea);}

    // Salvar no Google Sheets
    const data={reportDate,userName,userShift,workedArea,operationNumber,activitiesDone,pendingItems,actionPlans,observations};
    fetch('https://script.google.com/macros/s/AKfycbwWj8mM2QhPESaIFbNsuM6fSX4gQW1V8FwxpM9aCr7rq4O3rqJgXCC6aw5gOWoRQ5Pr/exec', {
        method:'POST', body:JSON.stringify(data)
    })
    .then(res=>res.json())
    .then(r=>showMessage("Dados salvos com sucesso!","success"))
    .catch(e=>showMessage("Erro ao salvar os dados.","error"));
}
</script>

</body>
</html>
