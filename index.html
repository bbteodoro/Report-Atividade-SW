<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Relat√≥rio de Atividades - Time de Software</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: "Inter", sans-serif;
      background-color: #f3f4f6;
    }
    textarea::placeholder { color: #9ca3af; }
    input:focus, textarea:focus {
      outline: none;
      border-color: #6366f1;
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
    }
    .message-box {
      padding: 0.75rem 1rem;
      border-radius: 0.375rem;
      font-size: 0.875rem;
      font-weight: 500;
      text-align: center;
      margin-top: 1rem;
      transition: opacity 0.3s ease-in-out;
    }
    .message-box.success { background-color: #d1fae5; color: #065f46; }
    .message-box.error { background-color: #fee2e2; color: #991b1b; }
    .message-box.hidden { opacity: 0; height: 0; padding: 0; overflow: hidden; }
  </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">
  <div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-2xl border border-gray-200">
    <!-- LOGO DA EMPRESA -->
    <div class="flex justify-center mb-4">
      <img src="Logo.jpg" alt="Logo da Empresa" class="h-16 w-auto">
    </div>

    <h1 class="text-3xl font-bold text-center text-gray-800 mb-6">
      üìù Relat√≥rio de Atividades - Time de Software
    </h1>

    <form id="reportForm" class="space-y-5">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label for="reportDate" class="block text-sm font-medium text-gray-700 mb-1">Data:</label>
          <input type="date" id="reportDate" class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md" required>
        </div>
        <div>
          <label for="userName" class="block text-sm font-medium text-gray-700 mb-1">Nome do Colaborador:</label>
          <input type="text" id="userName" placeholder="Seu Nome Completo" class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md" required>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label for="userShift" class="block text-sm font-medium text-gray-700 mb-1">Turno:</label>
          <select id="userShift" class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md" required>
            <option value="">Selecione o Turno</option>
            <option value="Manh√£">Manh√£</option>
            <option value="Tarde">Tarde</option>
            <option value="Noite">Noite</option>
            <option value="Integral">Integral</option>
          </select>
        </div>
        <div>
          <label for="workedArea" class="block text-sm font-medium text-gray-700 mb-1">√Årea Trabalhada:</label>
          <input type="text" id="workedArea" placeholder="Ex: Arma√ß√£o, Brancard, Soub, etc." class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md" required>
        </div>
      </div>

      <div>
        <label for="activitiesDone" class="block text-sm font-medium text-gray-700 mb-1">‚úÖ Atividades Realizadas:</label>
        <textarea id="activitiesDone" rows="5" placeholder="Liste as atividades conclu√≠das." class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md resize-y" required></textarea>
      </div>

      <div>
        <label for="pendingItems" class="block text-sm font-medium text-gray-700 mb-1">‚ö†Ô∏è Pend√™ncias:</label>
        <textarea id="pendingItems" rows="4" placeholder="Pend√™ncias ou 'Nenhuma'." class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md resize-y"></textarea>
      </div>

      <div>
        <label for="actionPlans" class="block text-sm font-medium text-gray-700 mb-1">‚û°Ô∏è Planos de A√ß√£o:</label>
        <textarea id="actionPlans" rows="4" placeholder="Descreva os pr√≥ximos passos." class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md resize-y" required></textarea>
      </div>

      <div>
        <label for="observations" class="block text-sm font-medium text-gray-700 mb-1">üí° Observa√ß√µes (opcional):</label>
        <textarea id="observations" rows="3" placeholder="Desafios, sucessos, sugest√µes..." class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md resize-y"></textarea>
      </div>

      <button type="button" onclick="generateAndCopyReport()" class="w-full flex justify-center py-3 px-4 rounded-md text-lg font-medium text-white bg-indigo-600 hover:bg-indigo-700 transition transform hover:scale-105">
        Gerar, Copiar e Enviar
      </button>

      <div id="messageBox" class="message-box hidden" role="alert"></div>
    </form>
  </div>

  <script>
    const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxlwq7Pj7y6PpghF0VzRy3hw_VGq-g5dqhBTQq8iLJJ7QF07FG9NoHiDHRtM-SMS5F9eA/exec";

    document.addEventListener('DOMContentLoaded', () => {
      const today = new Date();
      const y = today.getFullYear();
      const m = String(today.getMonth() + 1).padStart(2, '0');
      const d = String(today.getDate()).padStart(2, '0');
      document.getElementById('reportDate').value = `${y}-${m}-${d}`;
    });

    function showMessage(msg, type = 'success') {
      const box = document.getElementById('messageBox');
      box.textContent = msg;
      box.className = `message-box ${type}`;
      setTimeout(() => box.classList.add('hidden'), 3000);
    }

    async function generateAndCopyReport() {
      const reportDate = document.getElementById('reportDate').value;
      const userName = document.getElementById('userName').value;
      const userShift = document.getElementById('userShift').value;
      const workedArea = document.getElementById('workedArea').value.trim();
      const activitiesDone = document.getElementById('activitiesDone').value.trim();
      let pendingItems = document.getElementById('pendingItems').value.trim();
      const actionPlans = document.getElementById('actionPlans').value.trim();
      const observations = document.getElementById('observations').value.trim();

      if (!reportDate || !userName || !userShift || !workedArea || !activitiesDone || !actionPlans) {
        showMessage("Preencha todos os campos obrigat√≥rios.", "error");
        return;
      }

      if (pendingItems === "") pendingItems = "Nenhuma pend√™ncia.";

      const [y, m, d] = reportDate.split("-");
      const formattedDate = `${d}/${m}/${y}`;

      const reportText = `
üìù *RELAT√ìRIO DE ATIVIDADES - TIME DE SOFTWARE*

*Data:* ${formattedDate}
*Colaborador:* ${userName}
*Turno:* ${userShift}
*√Årea:* ${workedArea}

‚úÖ *Atividades Realizadas:*
${activitiesDone.split('\n').map(l => `‚Ä¢ ${l.trim()}`).join('\n')}

‚ö†Ô∏è *Pend√™ncias:*
${pendingItems.split('\n').map(l => `‚Ä¢ ${l.trim()}`).join('\n')}

‚û°Ô∏è *Planos de A√ß√£o:*
${actionPlans.split('\n').map(l => `‚Ä¢ ${l.trim()}`).join('\n')}

${observations ? `üí° *Observa√ß√µes:* ${observations}` : ""}
`;

      try {
        await navigator.clipboard.writeText(reportText);
        showMessage("Relat√≥rio copiado e enviado para planilha!", "success");

        // Envia para o Google Sheets
        await fetch(GOOGLE_SCRIPT_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            data: formattedDate,
            colaborador: userName,
            turno: userShift,
            area: workedArea,
            atividades: activitiesDone,
            pendencias: pendingItems,
            planos: actionPlans,
            observacoes: observations
          })
        });

      } catch (err) {
        showMessage("Erro ao copiar ou enviar.", "error");
      }
    }
  </script>
</body>

</html>


